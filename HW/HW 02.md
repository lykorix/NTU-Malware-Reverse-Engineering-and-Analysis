# Homework 2

## 1. Dharma

### 1. 
執行勒索病毒 Dharma 與 Process monitor 並截圖 Dharma 的 Process Tree，並分析說明每個 Process 行為
![image](https://github.com/lykorix/NTU-Malware-Reverse-Engineering-and-Analysis/assets/78891767/7629382b-820e-4255-b030-48bea45eb96f)

conhost.exe 即 Console Host Process，為 windows 應用程序處理機制。
mode.com 此例中會執行 mode con cp select=1251，選取字碼頁識別碼為 1251
的字碼。
vssadmin.exe 此例中會刪除系統上的所有 shadow copies。 mshta.exe 用於執行.HTA 文件，此例中會執行 Info.hta。

### 2. 
請解釋 MITRE ATT&CK 中的 T1490: Inhibit System Recovery 的 Technique 為何？如何偵測與防禦，並且在 Dharma 勒索病毒中找到攻擊的指令截圖
![image](https://github.com/lykorix/NTU-Malware-Reverse-Engineering-and-Analysis/assets/78891767/6741a0c4-9be5-4f49-832e-14412bcad160)
指令 delete shadows /all /quiet 會刪除系統上的所有 shadow copies。

Mitigations：
*	考慮實施 IT disaster recovery plans，包含用於恢復數據的定期備份程序，且確保備份存儲在系統之外。
*	考慮 technical controls 以防止禁用服務或刪除 system recovery 中涉及的文件。

Detection：
*	使用 process monitor 來監控涉及 inhibiting system recovery 的 binaries 執行和 command line 參數。
 
*	利用 Windows event logs
*	監控 system recovery 中涉及的服務狀態。
*	監控 registry 中與系統恢復功能相關的更改。

## 2. Sodinokibi

### 1. 
執行勒索病毒 Sodinokibi 與Process monitor 並找到 MITRE ATT&CK中的 T1490: Inhibit System Recovery 的 Technique 攻擊的指令截圖證明
![image](https://github.com/lykorix/NTU-Malware-Reverse-Engineering-and-Analysis/assets/78891767/bf1707d5-e90a-4405-9f4a-d5834cea9b88)
![image](https://github.com/lykorix/NTU-Malware-Reverse-Engineering-and-Analysis/assets/78891767/db7a6bf4-3647-4cea-939a-6a2c153c9f93)

a.
觸發時間: 2022/11/1 上午  03:17:47.1322365
Technique 名稱: Inhibit System Recovery
Technique 說明: 刪除系統上的所有shadow copies

![image](https://github.com/lykorix/NTU-Malware-Reverse-Engineering-and-Analysis/assets/78891767/75da74c1-75bb-4a95-8114-5251275330b0)

b.
觸發時間: 2022/11/1 上午 03:17:47.1322365	
Technique 名稱: Command and Scripting Interpreter: PowerShell
Technique 說明: 攻擊者濫用 PowerShell 命令和腳本

### 2. 
執行勒索病毒 Sodinokibi 與Process monitor 並將它所使用的 MITRE ATT&CK 的 Technique 列於下表

a.
觸發時間: 2022/11/1 上午 03:17:47.1322365
Technique 名稱: Inhibit System Recovery
Technique 說明: 刪除系統上的所有shadow copies
![image](https://github.com/lykorix/NTU-Malware-Reverse-Engineering-and-Analysis/assets/78891767/20ef4865-b148-4d5b-802a-17897c8f36fa)

b.
觸發時間: 2022/11/1 上午 03:17:47.1322365
Technique 名稱: Command and Scripting Interpreter: PowerShell
Technique 說明: 攻擊者濫用 PowerShell 命令和腳本
![image](https://github.com/lykorix/NTU-Malware-Reverse-Engineering-and-Analysis/assets/78891767/412c9919-877c-4f98-81cd-8d2f61c44713)

c.
觸發時間: 2022/11/1 上午 03:18:39.1089562
Technique 名稱: Defacement: Internal Defacement
Technique 說明: 攻擊者破壞內部的系統，以恐嚇或誤導用戶，從而破壞系統的完整性。此例通過更換桌面壁紙修改系統
![image](https://github.com/lykorix/NTU-Malware-Reverse-Engineering-and-Analysis/assets/78891767/38d8535e-37e3-4041-856e-2ad36c87181f)

d.
觸發時間: 2022/11/1 上午 03:18:23.7122141
Technique 名稱: Modify Registry
Technique 說明: 攻擊者修改 Windows Registry 之值以幫助惡意程式執行。
![image](https://github.com/lykorix/NTU-Malware-Reverse-Engineering-and-Analysis/assets/78891767/4dea33a8-bca6-4da0-8d65-c0990d6f03e7)

e.
Technique 名稱: Data Destruction
Technique 說明: 攻擊者破壞系統上的大量數據和文件，以中斷系統和服務的可用性。
![image](https://github.com/lykorix/NTU-Malware-Reverse-Engineering-and-Analysis/assets/78891767/beb6ce97-305c-44eb-b134-d3002f350c70)

f.
Technique 名稱: Data Destruction
Technique 說明: 攻擊者破壞系統上的大量數據和文件，以中斷系統和服務的可用性。
![image](https://github.com/lykorix/NTU-Malware-Reverse-Engineering-and-Analysis/assets/78891767/e8940ee9-5ddd-46f8-a59e-d483ca2e4fa4)
